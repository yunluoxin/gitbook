# RVM çš„å®‰è£…

## ç®€ä»‹

â€‹	**RVM** æ˜¯ Ruby Version Manager çš„ç®€ç§°ï¼Œå³ Ruby ç‰ˆæœ¬ç®¡ç†å™¨ã€‚



## Why not system ruby ? 

â€‹	ä¸ºä»€ä¹ˆè¦ç”¨ RVMï¼Ÿè‹¹æœå·²ç»æœ‰å†…ç½®çš„ ruby äº†ï¼Œæœ‰ä»€ä¹ˆå¿…è¦å®‰è£…å…¶ä»–ç‰ˆæœ¬å‘¢ï¼Ÿ

â€‹	æ ¹æ®å‚è€ƒæ–‡ç« <sup>[1]</sup>çš„ä»‹ç»ï¼ŒMacOS å†…ç½®çš„ ruby æ˜¯ç»™è‡ªå·±ç³»ç»Ÿç”¨çš„ï¼Œä¸€èˆ¬æ˜¯æ¯”è¾ƒä½çš„ç‰ˆæœ¬ï¼ˆæ¯”å¦‚æˆ‘å†™æ­¤æ–‡ç« æ—¶å€™æ˜¯2.6ï¼‰ã€‚è€Œå‡¡æ˜¯æˆ‘ä»¬æ‰§è¡Œ gem å‘½ä»¤ï¼Œéœ€è¦ç”¨åˆ° sudo çš„ï¼Œæ¯”å¦‚ `sudo gem install ffi` éƒ½ä»£è¡¨ç€è¦å¯¹ç³»ç»Ÿçš„ ruby è¿›è¡Œæ”¹å˜ï¼

â€‹	æ‰€ä»¥ï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯è‡ªå·±å®‰è£…å¦å¤–ä¸€ä¸ª rubyï¼Œæœ‰å‡ ä¸ªä¼˜åŠ¿ï¼š

- å®‰è£…æ—¶å€™ä¸éœ€è¦ç”¨åˆ° sudo
- ä¸ä¼šæ”¹å˜ç³»ç»Ÿ ruby
- å¯ä»¥å®‰è£…æœ€æ–°ç¨³å®šç‰ˆæœ¬çš„ ruby



## å®‰è£…è¿‡ç¨‹

1. ç”±äºéœ€è¦å®‰è£… mpapis public keyï¼ˆåˆ«é—®æˆ‘æ˜¯å•¥ï¼Œå“ˆå“ˆğŸ˜„ï¼‰ï¼Œæ‰€ä»¥éœ€è¦ gpgã€‚ä½†æ˜¯ MacOS åŸç”Ÿä¸æ”¯æŒ gpgï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆå®‰è£… gpgï¼è€Œå®‰è£… gpgï¼Œæˆ‘ä»¬éœ€è¦ Homebrewï¼Œæ‰€ä»¥æ²¡å®‰è£… homebrew çš„ï¼Œéœ€è¦å…ˆå»å®‰è£…<sup>[4]</sup>å“¦ï¼Œæœ¬æ–‡ä¸æ¶‰åŠæ­¤ï¼

   ```shell
   # å®‰è£… gpg
   brew install gnupg
   # å®‰è£… mpapis public key
   gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB
   ```

   > æ³¨æ„ï¼š gpg çš„ keys ä¼šå‘ç”Ÿå˜åŒ–ï¼å¦‚æœå‘ç°ä¸Šé¢å‘½ä»¤å‡ºç°é—®é¢˜ï¼Œè¯·æ‰“å¼€ [RVM å®˜ç½‘å®‰è£…æ•™ç¨‹](https://rvm.io/rvm/install) å¤åˆ¶æœ€æ–° keysï¼Œæ›¿æ¢ä¸Šé¢çš„å‘½ä»¤çš„ **keys éƒ¨åˆ†**ï¼ ï¼ˆåªè¦æ›¿æ¢ keysï¼Œ å…¶ä»–éƒ¨åˆ†ä¸è¦å“¦~  å³åªè¦æ›¿æ¢ **409B6B....** åˆ°æœ€åï¼‰

2. å®‰è£… rvm

   ```shell
   # å®‰è£… rvm æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬
   \curl -sSL https://get.rvm.io | bash -s stable --ruby
   ```

3. å…³é—­ã€é‡å¼€ç»ˆç«¯ï¼Œä½¿å¾—æœ€æ–°çš„ç¯å¢ƒæ”¹å˜ç”Ÿæ•ˆ

4. ç»ˆç«¯ä¸­æ‰§è¡Œ `rvm list`, å¦‚æœä½ çœ‹åˆ°äº†ç±»ä¼¼ä¸‹é¢çš„ ruby ç‰ˆæœ¬åˆ—è¡¨ï¼Œå³ä»£è¡¨ rvm å·²ç»å®‰è£…æˆåŠŸå•¦ï¼ğŸ’æ­å–œğŸ’

   ```shell
   =* ruby-3.0.0 [ arm64 ]
   
   # => - current
   # =* - current && default
   #  * - default
   ```



## ä½¿ç”¨

åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„ ruby ç‰ˆæœ¬

```shell
rvm list
```

é€šè¿‡ `rvm use` å‘½ä»¤ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªç”Ÿæ•ˆçš„ Ruby ç‰ˆæœ¬

```shell
rvm use 3.0.0
```

ä¸Šé¢çš„å‘½ä»¤åªæ˜¯åœ¨å½“å‰æ§åˆ¶å°ç”Ÿæ•ˆï¼Œå¦‚æœä½ éœ€è¦ä¹‹åæ–°æ‰“å¼€çš„æ‰€æœ‰æ§åˆ¶å°éƒ½ç”Ÿæ•ˆï¼Œä½ éœ€è¦ä½¿ç”¨ defaultï¼š

```shell
rvm use 3.0.0 --default
```

é€šè¿‡ `ruby -v`ï¼Œå¯ä»¥çŸ¥é“å½“å‰æ­£åœ¨ä½¿ç”¨çš„ ruby ç‰ˆæœ¬ï¼Œæ¥éªŒè¯æ˜¯å¦åˆ‡æ¢ç‰ˆæœ¬æˆåŠŸã€‚

```shell
ruby -v
# ruby 3.0.0p0 (2020-12-25 revision 95aff21468) [arm64-darwin21]
```



### å®‰è£…æ›´å¤šç‰ˆæœ¬çš„ ruby

åˆ—å‡ºå·²çŸ¥çš„ Ruby ç‰ˆæœ¬

```shell
# å¾—åˆ°ä½ å¯ä»¥å®‰è£…çš„æ‰€æœ‰ ruby ç‰ˆæœ¬åˆ—è¡¨
rvm list known 
```

å®‰è£…ä¸€ä¸ª Ruby ç‰ˆæœ¬

```shell
rvm install 2.7 --disable-binary
```



### å…³äºå®‰è£…å…¶ä»– Gem

åœ¨ä½ æŒ‡å®šäº†é»˜è®¤çš„ ruby ç‰ˆæœ¬åï¼Œrvm ç›´æ¥å˜æ›´äº† shell ç¯å¢ƒï¼Œæ‰€ä»¥å®‰è£… gem ä»€ä¹ˆçš„ï¼Œå°±å’Œå¹³æ—¶ä¸€æ ·çš„ï¼**ä¸ç”¨åŠ **ä»€ä¹ˆ rvm å‰ç¼€!

```shell
gem install json
```

>  è¿‡ç¨‹ä¸­ä¸åº”è¯¥ç”¨åˆ° sudoï¼



## å¸è½½æŸä¸ªç‰ˆæœ¬ ruby

æ³¨æ„ï¼Œè¿™é‡Œçš„å¸è½½ç«Ÿç„¶æ²¡å’Œå®‰è£…çš„ **install** å¯¹åº”çš„ uninstallï¼Œç”¨ **remove** !

```shell
rvm remove 3.0.0
```



## å®‰è£…æ’ä»¶å¤ªæ…¢ï¼Ÿ

å¯ä»¥å°è¯•æ›´æ¢æºï¼ˆæœªå®éªŒè¿‡ï¼Œæ ¡éªŒè¿‡ç½‘å€æ˜¯æœ‰æ•ˆçš„ï¼‰ï¼š

```shell
echo "ruby_url=https://cache.ruby-china.com/pub/ruby" > ~/.rvm/user/db
```



## å‚è€ƒæ–‡ç« 

1. [Stack overflow](https://stackoverflow.com/questions/69460048/unable-to-install-cocoapods-in-macos-monterey-version-12-0-beta-xcode-13-013a)
2. [How to Install Ruby on macOS with RVM](https://jeffreymorgan.io/articles/ruby-on-macos-with-rvm/)
3. [RVM å®˜ç½‘å®‰è£…æ•™ç¨‹](https://rvm.io/rvm/install)
4. [Ruby China WIKI](https://ruby-china.org/wiki/rvm-guide)
5. [ARM64 ç‰ˆæœ¬ Mac çš„ Homebrew å®‰è£…æ•™ç¨‹](https://zhuanlan.zhihu.com/p/341831809)